## redis和mongodb
### 单个文档大小
&ensp;&ensp;注：1KB=1024B 1MB=1024KB 1GB =1024MB
- mongobd
  + MongoDB存储在BSON(二进制JSON)中，最大BSON文档大小为16MB
- redis
  + 虽然redis的Key的大小上限为512M,但是一般建议key的大小不要超过1KB，这样既可以节约存储空间，又有利于Redis进行检索
  + redis的value的最大值也是512M。对于String类型的value值上限为512M，而集合、链表、哈希等key类型，单个元素的value上限也为512M

## redis可以当数据库吗?
### redis出现
&ensp;&ensp;大多数数据库，由于经常和磁盘打交道，在高并发场景下，响应会非常的慢。为了解决这种速度差异，大多数系统都习惯性的加入一个缓存层，来加速数据的读取。
同时redis也是一个基于内存的键值对数据库。如果数据量很大都存储到内存中会增加成本，而且一般redis都会开启持久化，如果数据量较大，那么持久化的就会变得很多，
增加了redis 的压力，同时会降低redis的性能，因为很大一部分资源都用于持久化数据了。加上数据量达到了上百G，那么就要耗费上百G的内存，成本上也划不过来。

### 能否做数据库用取决于如下几个条件
- 数据量，毕竟内存数据库，还是受限于内存的容量
- 数据的结构，是否能够将关系型数据结构都转换为key/value的形式
- 查询的效率，对范围查询等，是否能转换为高效的hash索引查询
- 如果打算存储一些临时数据，数据规模不大，不需要太复杂的查询，但是对性能的要求比较高，那可以拿redis当数据库使用


## Redis使用Lua脚本为什么能保证原子性

Redis使用同一个Lua解释器来执行所有命令，同时，Redis保证以一种原子性的方式来执行脚本：
当lua脚本在执行的时候，不会有其他脚本和命令同时执行，这种语义类似于 MULTI/EXEC。从别的客户端的视角来看，
一个lua脚本要么不可见，要么已经执行完。

url：https://redis.io/docs/interact/programmability/eval-intro/

## Redis 五种数据结构的使用场景

1. 字符串（String）
   Redis 中的字符串是最基本的数据结构，可以存储任何类型的值（如数字、字符串、JSON 等），最大可以存储 512MB 的数据。  

  使用场景：  
  缓存简单数据：适用于缓存常用的键值对，如用户信息、配置数据等。  
  计数器：可以通过 INCR、DECR、INCRBY 等操作对整数类型的数据进行自增、自减，常用于实现计数功能，如网站访问量统计。  
  分布式锁：利用字符串类型可以实现简单的分布式锁，通过 SETNX 和 EXPIRE 来实现锁的原子操作。  
  会话管理：存储用户的 session 信息。  

2. 哈希（Hash）
  哈希表（Hash）是一种键值对的集合，类似于数据库中的行，可以存储对象的多个字段。每个字段可以是字符串类型。  
 
  使用场景：  
  存储对象：适用于存储用户信息、产品详情等对象化数据，利用哈希表可以将对象的多个字段存储在一个键下。  
  减少内存占用：哈希表可以节省内存，特别是在字段较多但数据量较小时，避免创建多个字符串键。  
  部分更新：可以对对象中的某个字段进行独立的增删改查，而不必修改整个对象。  

3. 列表（List）
  列表是一个双向链表，支持从左边（LPUSH）或右边（RPUSH）插入元素，以及从左边（LPOP）或右边（RPOP）弹出元素。    

  使用场景：  
  消息队列：可以用作简单的队列实现，使用 LPUSH 和 RPOP 来实现先进先出的队列模型。  
  最新消息列表：可以通过 LPUSH 实现倒序的消息列表，如聊天记录、操作日志等。  
  任务调度：在任务处理的场景中，列表可以用于存储待处理任务。  

4. 集合（Set）
  集合是一种无序的、元素唯一的数据结构。集合中的每个元素都是唯一的，Redis 通过哈希表来实现集合的唯一性。  

  使用场景：  
  标签系统：适用于存储唯一性的数据集合，例如用户标签、兴趣分类等。  
  交集、并集和差集：集合支持交集、并集、差集等操作，适合用于社交网络中实现共同好友、推荐等功能。  
  去重操作：可以用于去重，避免重复数据的插入。  

5. 有序集合（Sorted Set）
  有序集合和集合类似，但每个元素都关联一个分数 (score)，并且按照分数排序。可以通过分数对集合中的元素进行排序。  

  使用场景：  
  排行榜系统：适用于实现排行榜，如游戏中的积分排行榜、热点文章排名等。  
  延时队列：通过分数字段表示延时时间，按时间顺序来执行任务，类似延时队列的功能。  
  推荐系统：可用于存储评分、权重等数据，依据权重来推荐物品、用户等。  

## Redis集群模式有哪几种
1. 主从复制：适合读多写少场景，提供读写分离。
  主从复制是一种简单的集群模式，主节点（Master）处理所有写操作，从节点（Slave）复制主节点的数据并处理读操作。
  从节点可以有多个，负责分担读请求，提高读取性能，并在主节点故障时接管。
2. 哨兵模式：在主从复制基础上提供自动故障转移，适合对高可用性要求较高的场景。
   Redis 哨兵模式在主从复制的基础上增加了自动故障转移和监控功能。哨兵节点（Sentinel）会监控 Redis 实例，当主节点发生故障时，自动将某个从节点提升为主节点。
3. Redis Cluster：支持自动分片和高可用性，适合大规模数据和高并发应用。
   Redis Cluster 是 Redis 的原生集群解决方案，支持自动分片（sharding）和高可用性。数据会自动分布在多个节点上，每个节点负责一部分数据（分区）。
4. 代理模式：通过代理层实现集群功能，适合中小规模集群和透明化集群管理。
   代理模式通过一个代理层来实现 Redis 集群的功能。客户端向代理层发送请求，代理层将请求路由到正确的 Redis 实例
5. 自定义分片：客户端自己控制数据分片和路由，适合定制化需求。
   自定义分片由客户端负责数据分片和路由。客户端根据某种哈希函数决定数据存储在哪个 Redis 实例上
